(function(){var t={5146:function(t,e,i){"use strict";i.d(e,{A:function(){return c}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"vertical-wrapper",staticStyle:{padding:"0 20%"}},[e("div",{staticClass:"horizontal-wrapper"},[e("md-switch",{staticClass:"md-primary",model:{value:t.dhcp,callback:function(e){t.dhcp=e},expression:"dhcp"}},[t._v("DHCP enabled")]),e("div"),e("md-button",{staticClass:"md-raised md-primary",on:{click:t.saveNetworkConfig}},[t._v("Speichern")])],1),t.dhcp?t._e():e("div",{staticClass:"horizontal-wrapper",staticStyle:{gap:"20pt"}},[e("md-field",{class:{"md-invalid":!t.ipValid},staticStyle:{flex:"3 0 0"}},[e("label",{attrs:{for:""}},[t._v("IP Adresse")]),e("md-input",{model:{value:t.ip,callback:function(e){t.ip=e},expression:"ip"}}),e("span",{staticClass:"md-error"},[t._v("Invalid IP")])],1),e("md-field",[e("label",{attrs:{for:""}},[t._v("Cider")]),e("md-input",{model:{value:t.cider,callback:function(e){t.cider=e},expression:"cider"}})],1)],1),t.dhcp?t._e():e("div",{staticClass:"horizontal-wrapper",staticStyle:{gap:"20pt"}},[e("md-field",{},[e("label",{attrs:{for:""}},[t._v("Gateway")]),e("md-input",{model:{value:t.gateway,callback:function(e){t.gateway=e},expression:"gateway"}})],1),e("md-field",{class:{"md-invalid":!t.dnsValid}},[e("label",{attrs:{for:""}},[t._v("DNS")]),e("md-input",{model:{value:t.dns,callback:function(e){t.dns=e},expression:"dns"}}),e("span",{staticClass:"md-error"},[t._v("Invalid DNS")])],1)],1)])},n=[],a=i(9956),o={name:"network-settings",beforeRouteEnter(t,e,i){i((t=>{fetch(`${t.$hostname}/network/get-config`,{headers:{Authorization:t.token}}).then((async e=>{if(200!=e.status)return;const i=await e.json();t.dhcp=i.dhcp,t.ip=i.ip,t.cider=i.cider,t.gateway=i.gateway,t.dns=i.dns}))}))},methods:{async saveNetworkConfig(){if(!this.dhcp&&!this.checkSameNetwork(this.ip,this.cider,this.gateway)){const{isConfirmed:t}=this.$swal.fire({icon:"warning",title:"Gateway nicht im Netzwerk",text:"Gateway nicht im Netzwerk, dies kann zu Kommunikationsproblemen führen.\nMöchten Sie fortfahren? ",showDenyButton:!0,denyButtonText:"Nein",showConfirmButton:!0,confirmButtonText:"Weiter"});if(!t)return}const t={dhcp:this.dhcp,ip:this.ip,cider:this.cider,gateway:this.gateway,dns:this.dns};fetch(`${this.$hostname}/network/set-config`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:this.token},body:JSON.stringify(t)}).then((t=>{200!=t.status?this.$swal.fire({title:"Fehler",text:"Bei der Netzwerkeinstellung ist etwas fehlgeschlagen",icon:"error"}):this.$swal.fire({title:"Erfolgreich",text:"Netzwerkeinstellung gespeichert und bei Neustart aktiv",icon:"success"})}))},ipToInt(t){return t.split(".").reduce(((t,e)=>(t<<8)+parseInt(e,10)),0)>>>0},checkSameNetwork(t,e,i){const s=~((1<<32-parseInt(e))-1)>>>0,n=this.ipToInt(t)&s,a=this.ipToInt(i)&s;return n===a}},computed:{ipValid(){return(0,a.isValidIPv4)(this.ip)},dnsValid(){return(0,a.isValidIPv4)(this.dns)},token(){return this.$store.getters.token}},data(){return{dhcp:!0,ip:"",cider:"24",gateway:"",dns:""}}},r=o,d=i(1656),l=(0,d.A)(r,s,n,!1,null,null,null),c=l.exports},145:function(t,e,i){"use strict";i.d(e,{A:function(){return g}});var s=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{overflow:"scroll"}},[t.configLoading?e("md-progress-bar",{staticClass:"md-primary",attrs:{"md-mode":"query"}}):t._e(),e("div",{ref:"table",staticStyle:{margin:"10pt"}})],1)},n=[],a=i(8434),o=i.n(a),r=i(9956),d=[[!0,"","","","","",""]];const l="background-color: rgba(0, 0, 0, 0);",c="background-color: rgba(255, 0, 0, 0.5);",u="background-color: rgba(249, 215, 28, 0.5);";var p={name:"readS7-view",computed:{config(){return this.$store.getters.getConfig},resetUserInput(){return this.$store.getters.getResetUserInput},configLoading(){return this.$store.getters.getConfigLoading}},methods:{updateConfigEntire(){this.firstUpdate=!0,this.$store.dispatch("getConfig").then((()=>{const t=this.config.data.filter((t=>"s7"==t.type)).map((t=>[t.active,t.name,t.unit,t.ip,t.db,t.offset,t.length,t.datatype,t.value?t.value:"",t.readError,!1])),e="ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=t.reduce(((t,i,s)=>(i[9]&&(i.forEach(((i,n)=>t[e[n]+(s+1)]=c)),i[8]=i[9]),t)),{});t.length?this.spreadsheet.setData(t):this.spreadsheet.setData([Array(10).fill(0).map((()=>""))]),this.spreadsheet.setStyle(i),this.firstUpdate=!1})),this.$store.commit("s7-invalid-inputs-reset")},updateConfigValues(){this.$store.dispatch("updateConfig").then((t=>{const e=t.data.filter((t=>"s7"==t.type)).map((t=>[t.active,t.name,t.unit,t.ip,t.db,t.offset,t.length,t.datatype,t.value?t.value:"",t.readError])),i="ABCDEFGHIJKLMNOPQRSTUVWXYZ",s={},n=this.spreadsheet.getData();this.resetUserInput&&(this.$store.commit("set-reset-user-input",!1),this.spreadsheet.setColumnData(10,n.map((()=>!1)))),n.forEach(((t,n)=>{const a=t[1],o=e.find((t=>t[1]===a));if(o&&!t[10]){let e=o[8];const a=o[9];void 0!=a&&null!=a?(t.forEach(((t,e)=>s[i[e]+(n+1)]="background-color: rgba(255, 0, 0, 0.5);")),e=a):t.forEach(((t,e)=>s[i[e]+(n+1)]="background-color: white")),this.spreadsheet.setValueFromCoords(8,n,e,!0),this.spreadsheet.setValueFromCoords(9,n,a,!0)}})),this.spreadsheet.setStyle(s),this.configLoading&&t.data.every((t=>t.value||t.readError))&&this.$store.commit("set-config-loading",!1)}))},changeTable(t,e,i,s,n){const a=!e;if(8==i||9==i||10==i||this.firstUpdate)return;let o=!0;if(1==i)o=""!=n&&!this.spreadsheet.getColumnData(1).some(((t,e)=>t==n&&e!=s));else if(3==i)o=(0,r.isValidIPv4)(n);else if(4==i||6==i)o=Number.isInteger(Number(n));else if(5==i){const t=Number(n);o=!isNaN(t)}if(this.spreadsheet.getValueFromCoords(10,s)||this.updateStyleRow(s,l),o){this.updateStyleCell(i,s,l),!a&&this.$store.commit("s7-invalid-inputs-add",-1);const t=this.spreadsheet.getData().map((t=>({active:t[0],type:"s7",name:t[1],unit:t[2],ip:t[3],db:t[4],offset:t[5],length:t[6],datatype:t[7]})));this.$store.commit("change-s7-config",t)}else this.updateStyleCell(i,s,u),this.$store.commit("s7-invalid-inputs-add",1);this.spreadsheet.setValueFromCoords(10,s,!0)},saveConfigFile(){},updateStyleCell(t,e,i){if(!this.spreadsheet)return;const s=this.spreadsheet.getStyle(),n="ABCDEFGHIJKLMNOPQRSTUVWXYZ",a=n[t]+(parseInt(e)+1);s[a]=i,this.spreadsheet.setStyle(s)},updateStyleRow(t,e){if(!this.spreadsheet)return;const i=this.spreadsheet.getWidth();for(let s=0;s<i.length;s++)this.updateStyleCell(s,t,e)},onpaste(t,e){const i=this.spreadsheet.getSelectedRows(!0),s=this.spreadsheet.getSelectedColumns();i.forEach(((i,n)=>{s.forEach(((s,a)=>{this.changeTable(t,null,s,i,e[n][a])}))}))}},mounted(){const t={data:d,columns:[{type:"checkbox",title:"Active",width:"50px"},{type:"text",title:"Name",width:"200px"},{type:"text",title:"Unit",width:"120px"},{type:"text",title:"IP",width:"120px"},{type:"text",title:"DB",width:"120px"},{type:"text",title:"offset",width:"120px"},{type:"text",title:"length",width:"120px"},{type:"dropdown",title:"DataType",width:"120px",source:["bit","byte","word","real","dint"]},{type:"text",title:"Value",width:"180px",readOnly:!0},{type:"hidden",title:"failure"},{type:"hidden",title:"user-input"}],onchange:this.changeTable,onpaste:this.onpaste};this.updateConfigEntire(),this.spreadsheet=o()(this.$refs["table"],t);const e=this;this.requestInterval=setInterval((()=>{e.updateConfigValues()}),2e3)},beforeRouteLeave(t,e,i){this.requestInterval&&clearInterval(this.requestInterval),i()},data(){return{requestInterval:0,spreadsheet:0,firstUpdate:!1,loading:!0}}},h=p,f=i(1656),m=(0,f.A)(h,s,n,!1,null,null,null),g=m.exports},9956:function(t){function e(t){const e=t.split(".");if(4!==e.length)return!1;for(let i of e){const t=parseInt(i,10);if(isNaN(t)||t<0||t>255||i!==t.toString())return!1}return!0}t.exports={isValidIPv4:e}},8054:function(t,e,i){"use strict";var s=i(2856),n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"vertical-wrapper",attrs:{id:"app"}},[e("router-view")],1)},a=[],o={name:"App",components:{}},r=o,d=i(1656),l=(0,d.A)(r,n,a,!1,null,null,null),c=l.exports,u=i(1594),p=i(7211),h=i.n(p),f=i(99),m=i.n(f),g=function(){var t=this,e=t._self._c;return e("md-app",{staticStyle:{height:"100%"},attrs:{"md-waterfall":"","md-mode":"fixed"}},[e("md-app-toolbar",{staticClass:"md-primary"},[e("div",{staticClass:"md-toolbar-row"},[e("div",{staticClass:"md-toolbar-section-start"},[e("md-button",{staticClass:"md-icon-button",on:{click:function(e){t.menuVisible=!t.menuVisible}}},[e("md-icon",{attrs:{"md-src":i(1886)}},[t._v("menu")])],1),e("span",{staticClass:"md-title"},[t._v("IotAdapter Einstellungen")]),t.s7InvalidInputs?e("div",{staticStyle:{margin:"0 10pt",position:"relative"}},[e("md-icon",{attrs:{"md-src":i(2272)}}),e("i",{staticClass:"badge"},[t._v(t._s(t.s7InvalidInputs))])],1):t._e()],1),e("div",{staticClass:"md-toolbar-section-end"},[e("md-button",{staticClass:"md-icon-button",on:{click:t.saveConfiguration}},[e("md-icon",{attrs:{"md-src":i(2396)}})],1),e("div")],1)])]),e("md-app-drawer",{attrs:{"md-active":t.menuVisible},on:{"update:mdActive":function(e){t.menuVisible=e},"update:md-active":function(e){t.menuVisible=e}}},[e("md-toolbar",{staticClass:"md-transparent",attrs:{"md-elevation":"0"}},[t._v("Navigation")]),e("md-list",[e("router-link",{attrs:{to:{name:"reads7-view"}},nativeOn:{click:function(e){t.menuVisible=!1}}},[e("md-list-item",[e("md-icon",{attrs:{"md-src":i(6052)}},[t._v("Icon")]),e("span",{staticClass:"md-list-item-text"},[t._v("S7 PUT&GET")])],1)],1),e("md-list-item",{staticClass:"hide"},[e("md-icon",[t._v("send")]),e("span",{staticClass:"md-list-item-text"},[t._v("AnoPi")])],1),e("router-link",{attrs:{to:{name:"network-settings"}},nativeOn:{click:function(e){t.menuVisible=!1}}},[e("md-list-item",[e("md-icon",{attrs:{"md-src":i(3573)}}),e("span",{staticClass:"md-list-item-text"},[t._v("Network Settings")])],1)],1)],1)],1),e("md-app-content",{staticStyle:{padding:"0"}},[e("router-view")],1)],1)},v=[],y={name:"home-view",computed:{s7InvalidInputs(){return this.$store.getters.getS7InvalidInputs},config(){return this.$store.getters.getConfig},token(){return this.$store.getters.token}},methods:{async saveConfiguration(){if(0!=this.s7InvalidInputs)return void this.$swal.fire({title:"Fehler",text:"In der S7 PUT&GET Konfiguration sind üngültige Eingaben",icon:"warning"});this.$store.commit("set-config-loading",!0),this.$store.commit("set-reset-user-input",!0);const t={config:this.config},e=await fetch(`${this.$hostname}/set-config`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:this.token},body:JSON.stringify(t)});e.ok||this.$store.dispatch("setConfig")}},data(){return{menuVisible:!1}}},w=y,b=(0,d.A)(w,g,v,!1,null,null,null),C=b.exports,k=function(){var t=this,e=t._self._c;return e("div",{staticClass:"centered-container"},[e("md-content",{staticClass:"md-elevation-3"},[e("div",{staticClass:"title"},[e("img",{attrs:{src:"https://vuematerial.io/assets/logo-color.png"}}),e("div",{staticClass:"md-title"},[t._v("IotAdapter")]),e("div",{staticClass:"md-body-1"},[t._v("Verwende die Raspberry Pi SSH Login Daten")])]),e("div",{staticClass:"form"},[e("md-field",{class:{"md-invalid":t.loginFailed}},[e("label",[t._v("Username")]),e("md-input",{attrs:{autofocus:""},model:{value:t.login.username,callback:function(e){t.$set(t.login,"username",e)},expression:"login.username"}}),e("span",{staticClass:"md-error"},[t._v("Invalid Creditals")])],1),e("md-field",{class:{"md-invalid":t.loginFailed},attrs:{"md-has-password":""}},[e("label",[t._v("Password")]),e("md-input",{attrs:{type:"password"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.auth.apply(null,arguments)}},model:{value:t.login.password,callback:function(e){t.$set(t.login,"password",e)},expression:"login.password"}}),e("span",{staticClass:"md-error"},[t._v("Invalid Creditals")])],1)],1),e("div",{staticClass:"actions md-layout md-alignment-center-space-between"},[e("div"),e("md-button",{staticClass:"md-raised md-primary",on:{click:t.auth}},[t._v("Log in")])],1),t.loading?e("div",{staticClass:"loading-overlay"},[e("md-progress-spinner",{attrs:{"md-mode":"indeterminate","md-stroke":2}})],1):t._e()]),e("div",{staticClass:"background"})],1)},I=[],x=(i(4114),{name:"App",data(){return{loading:!1,login:{username:"",password:""},loginFailed:!1}},methods:{auth(){this.loading=!0;const t=this.login;fetch(`${this.$hostname}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((async t=>{if(200==t.status){const e=await t.json();e.session_id&&(this.$store.commit("set-token",e.session_id),this.$router.push({name:"home-view"}))}else this.loginFailed=!0,this.loading=!1})),setTimeout((()=>{this.loading=!1}),5e3)}}}),S=x,_=(0,d.A)(S,k,I,!1,null,null,null),$=_.exports,A=new u.Ay({mode:"history",routes:[{path:"/login",name:"login-view",component:$},{path:"/",name:"home-view",component:C,redirect:{name:"reads7-view"},children:[{name:"reads7-view",path:"/home/config-reads7",component:i(145).A},{name:"network-settings",path:"/home/network-settings",component:i(5146).A}]},{path:"*",template:"<p>404</P>"}]}),T=i(1910);s["default"].use(T.Ay);const N=function(t){const e=s["default"].prototype.$hostname;return new T.Ay.Store({modules:{},state:()=>({token:"",config:{domain:"",data:[]},s7InvalidInputs:0,resetUserInput:!1,dataConfigLoading:!1}),mutations:{increment(t){t.count++},"set-token":function(t,e){t.token=e},"set-admin":function(t,e){t.admin=e},"s7-invalid-inputs-reset":function(t){t.s7InvalidInputs=0},"s7-invalid-inputs-add":function(t,e){t.s7InvalidInputs+=e,t.s7InvalidInputs<0&&(t.s7InvalidInputs=0)},"set-config":function(t,e){console.log("set-config"),t.config=e},"change-s7-config":function(t,e){const i=t.config.data.filter((t=>"s7"!==t.type));t.config.data=[...i,...e],this.commit("set-config",t.config)},"set-reset-user-input":function(t,e){t.resetUserInput=e},"set-config-loading":function(t,e){t.dataConfigLoading=e}},actions:{async getConfig({commit:i}){const s=await fetch(`${e}/get-config`,{method:"POST",headers:{Authorization:this.state.token}});if(200===s.status){const t=await s.json();i("set-config",t)}else 403==s.status&&(console.log("navigate to login"),t.push({name:"login-view"}))},async updateConfig(){const i=await fetch(`${e}/get-config`,{method:"POST",headers:{Authorization:this.state.token}});if(200===i.status){const t=await i.json();return t}403==i.status&&t.push({name:"login-view"})}},getters:{token(t){return t.token},getConfig(t){return t.config},getS7InvalidInputs(t){return t.s7InvalidInputs},getResetUserInput(t){return t.resetUserInput},getConfigLoading(t){return t.dataConfigLoading}}})};var O=N;s["default"].config.productionTip=!1,s["default"].use(h()),s["default"].use(m());const V=!0,P="http://172.17.16.199:5002";s["default"].prototype.$hostname=V?"":P,s["default"].use(u.Ay);const E=O(A);new s["default"]({router:A,store:E,render:t=>t(c)}).$mount("#app")},1886:function(t,e,i){"use strict";t.exports=i.p+"img/bars-solid.3ee61c76.svg"},3573:function(t,e,i){"use strict";t.exports=i.p+"img/ethernet-solid.cb77dc58.svg"},2396:function(t,e,i){"use strict";t.exports=i.p+"img/floppy-disk-solid.63aa336f.svg"},6052:function(t,e,i){"use strict";t.exports=i.p+"img/network-wired-solid.85050603.svg"},2272:function(t,e,i){"use strict";t.exports=i.p+"img/triangle-exclamation-solid.2f89f69a.svg"}},e={};function i(s){var n=e[s];if(void 0!==n)return n.exports;var a=e[s]={exports:{}};return t[s].call(a.exports,a,a.exports,i),a.exports}i.m=t,function(){var t=[];i.O=function(e,s,n,a){if(!s){var o=1/0;for(c=0;c<t.length;c++){s=t[c][0],n=t[c][1],a=t[c][2];for(var r=!0,d=0;d<s.length;d++)(!1&a||o>=a)&&Object.keys(i.O).every((function(t){return i.O[t](s[d])}))?s.splice(d--,1):(r=!1,a<o&&(o=a));if(r){t.splice(c--,1);var l=n();void 0!==l&&(e=l)}}return e}a=a||0;for(var c=t.length;c>0&&t[c-1][2]>a;c--)t[c]=t[c-1];t[c]=[s,n,a]}}(),function(){i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,{a:e}),e}}(),function(){i.d=function(t,e){for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){i.p="/"}(),function(){var t={524:0};i.O.j=function(e){return 0===t[e]};var e=function(e,s){var n,a,o=s[0],r=s[1],d=s[2],l=0;if(o.some((function(e){return 0!==t[e]}))){for(n in r)i.o(r,n)&&(i.m[n]=r[n]);if(d)var c=d(i)}for(e&&e(s);l<o.length;l++)a=o[l],i.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return i.O(c)},s=self["webpackChunkiotadapter_webclient"]=self["webpackChunkiotadapter_webclient"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=i.O(void 0,[504],(function(){return i(8054)}));s=i.O(s)})();
//# sourceMappingURL=app.fd8cdd9e.js.map